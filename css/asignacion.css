/* ==============================
   ASIGNACIÓN – Estilo compacto
   Scoped bajo .asig
============================== */

:root{
  /* Colores base */
  --ok:#2e7d32;
  --danger:#ef5350;
  --muted:#6b7280;
  --muted-pill:#9aa3af;

  --bar-req:#cfd8dc;
  --bar-asg:#7ec8e7;
  --bar-proc:#66bb6a;

  /* UI global */
  --border:#e2e8f0;
  --txt:#0f172a;
  --txt-soft:#6b7280;
  --bg-soft:#f7faf9;
  --primary:#0d6b61;
  --shadow:0 3px 10px rgba(0,0,0,.08);
}

/* ===== Toolbar / Leyenda ===== */
.asig .toolbar{display:flex;align-items:center;justify-content:space-between;margin:8px 0 10px}
.asig .toolbar .left{display:flex;gap:8px;align-items:center}
.asig .legend{display:flex;gap:12px;align-items:center;color:var(--txt-soft);font-size:.85rem}
.asig .bullet{width:10px;height:10px;border-radius:3px;display:inline-block}
.asig .b-req{background:var(--bar-req)} .asig .b-asg{background:var(--bar-asg)} .asig .b-proc{background:var(--bar-proc)}
.asig .toolbar .left label[for="anio"]{ margin-right:6px; color: var(--txt-soft); }

/* Forzar select nativo para que Materialize no lo esconda */
.asig #anio.browser-default{
  display:inline-block;
  min-width:140px;
  padding:6px 10px;
  border:1px solid var(--border);
  border-radius:8px;
  background:#fff;
  line-height:1.2;
  font-size:.9rem;
  color:var(--txt);
}

/* ===== Layout ===== */
.asig .wrap{width:100%;max-width:none;margin:0;padding:0 10px}
.asig #cards{width:100% !important;display:block}
html,body{overflow-x:hidden}

/* ===== Grid ===== */
.asig .grid{
  width:100%;
  display:grid;
  grid-template-columns:repeat(12, 1fr);
  gap:10px;
  align-items:start;
}
@media (max-width:1400px){ .asig .grid{ grid-template-columns:repeat(10,1fr);} }
@media (max-width:1200px){ .asig .grid{ grid-template-columns:repeat(8, 1fr);} }
@media (max-width:992px){  .asig .grid{ grid-template-columns:repeat(6, 1fr);} }
@media (max-width:768px){  .asig .grid{ grid-template-columns:repeat(4, 1fr);} }
@media (max-width:560px){  .asig .grid{ grid-template-columns:repeat(2, 1fr);} }
@media (max-width:380px){  .asig .grid{ grid-template-columns:1fr;} }

/* ===== Card base ===== */
.asig .card{background:transparent;border:none;border-radius:0;box-shadow:none;padding:0;cursor:pointer;position:relative}
.asig .card.lock{opacity:.45;pointer-events:none}

/* ===== Tarjeta ===== */
.asig .card--mock{
  padding:10px;
  border:1px solid var(--mock-border);
  border-radius:12px;
  background:#fff;
  transition:.2s ease all;
}
.asig .card--mock:hover{box-shadow:0 3px 8px rgba(0,0,0,.12);transform:translateY(-2px)}

/* Pastilla MES con gradiente según % asignado (CSS var --asg de 0–100) */
.asig .card--mock .month-pill{
  position:relative;
  color:#fff;
  border-radius:8px;
  font-weight:700;
  text-align:center;
  padding:6px 8px;
  font-size:.72rem;
  margin-bottom:8px;
  letter-spacing:.3px;
  background: linear-gradient(
    90deg,
    var(--ok) 0 calc(var(--asg,0)*1%),
    var(--danger) calc(var(--asg,0)*1%) 100%
  );
}
.asig .card--mock.full .month-pill{ background:var(--ok) !important; }
.asig .card--mock.zero .month-pill{ background:var(--muted-pill) !important; }

/* Contenido principal */
.asig .card--mock .tons-title{
  text-align:center;
  font-weight:600;
  font-size:.66rem;
  color:#4b5563;
  margin-bottom:2px;
}
.asig .card--mock .tons-value{
  text-align:center;
  font-weight:800;
  font-size:1.15rem;
  line-height:1.1;
  margin:2px 0 6px;
  color:#111827;
}

/* ===== Stats compactas (números, sin barras) ===== */
.asig .stats{ margin-top:4px; }

.asig .stat{
  display:grid;
  grid-template-columns: 12px 56px 1fr auto auto;
  align-items:center;
  column-gap:6px;
  font-size:.75rem;
  color:#374151;
  margin:4px 0;
}
.asig .stat .label{ color:#4b5563; }
.asig .stat b{ font-weight:800; color:#111827; }
.asig .stat .unit{ margin-left:4px; color:#6b7280; font-weight:600; }
.asig .stat .pct{ margin-left:8px; color:#6b7280; font-weight:600; }

.asig .dot{ width:8px; height:8px; border-radius:2px; display:inline-block; }
.asig .dot-asg{ background: var(--bar-asg); }
.asig .dot-proc{ background: var(--bar-proc); }
.asig .stat-missing{ grid-template-columns: 1fr auto; color: var(--danger); font-weight:700; }

/* ===== Panel Chart ===== */
.asig .panel-chart{
  margin-top:14px;
  padding:10px;
  border:1px solid var(--border);
  border-radius:10px;
  background:var(--bg-soft);
  box-shadow:var(--shadow)
}
.asig .panel-chart h3{margin:4px 6px 8px;font-size:.9rem;color:var(--primary)}

/* ===== Drawer (proveedores) ===== */
.drawer{
  position:fixed;top:78px;right:14px;width:420px;max-width:92vw;background:#fff;
  border:1px solid var(--border);border-radius:12px;box-shadow:var(--shadow);display:none;z-index:10400
}
.drawer header{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;border-bottom:1px solid var(--border);font-weight:700;color:var(--primary);font-size:.95rem}
.drawer .x{background:#fff;border:1px solid var(--border);border-radius:8px;padding:2px 8px;cursor:pointer}
.drawer .x:hover{filter:brightness(.96)}
.drawer .body{max-height:58vh;overflow:auto;padding:8px 12px}
.drawer table{width:100%;border-collapse:collapse;font-size:.9rem}
.drawer th,.drawer td{padding:8px;border-bottom:1px solid #eef1f3;text-align:left}
.drawer th{color:#0f1e1d;font-size:.86rem;font-weight:700;background:#f7faf9}

/* ===== Overlay y Modales ===== */
.asig-mask{position:fixed;inset:0;background:rgba(0,0,0,.45);display:none;z-index:10500}
.asig-modal{
  position:fixed;left:0;right:0;top:6vh;margin:0 auto;width:92%;max-width:760px;max-height:88vh;background:#fff;
  border:1px solid var(--border);border-radius:12px;box-shadow:0 18px 60px rgba(0,0,0,.25);display:none;z-index:10600;overflow:hidden
}
.asig-modal--sm{max-width:560px}
.asig-modal header{padding:10px 14px;font-weight:700;border-bottom:1px solid var(--border);color:var(--primary)}
.asig-modal .content{padding:12px 14px;max-height:calc(88vh - 110px);overflow:auto}
.asig-modal .actions{display:flex;gap:8px;justify-content:flex-end;padding:8px 14px;border-top:1px solid var(--border);background:#fff;position:sticky;bottom:0}

/* ===== Prompt de contraseña (centrado con flex) ===== */
.asig-pass{
  position:fixed; inset:0; display:none; z-index:10660;
  align-items:center; justify-content:center;
}
.asig-pass .backdrop{ position:absolute; inset:0; background:rgba(0,0,0,.25); }
.asig-pass .sheet{
  position:relative; width:90%; max-width:360px; background:#fff; border:1px solid var(--border);
  border-radius:12px; box-shadow:0 18px 60px rgba(0,0,0,.25); padding:12px 14px; z-index:1;
}
.asig-pass h4{ margin:0 0 8px; color:var(--primary) }
.asig-pass .actions button{ padding:8px 12px; border-radius:8px; border:1px solid var(--border); background:#fff; cursor:pointer; }
.asig-pass .actions .ok{ background:var(--primary); color:#fff; border-color:transparent }
.asig-pass .actions .ok:hover{ filter:brightness(.98) }

/* ===== Popover anclado a la tarjeta (Ver proveedores) ===== */
.asig-pop{
  position:absolute; z-index:10620; display:none;
  width:min(560px, 92vw);
  background:#fff; border:1px solid var(--border); border-radius:12px;
  box-shadow:0 16px 40px rgba(0,0,0,.22);
}
.asig-pop header{
  padding:10px 12px; border-bottom:1px solid var(--border);
  display:flex; align-items:center; justify-content:space-between;
  font-weight:700; color:var(--primary);
}
.asig-pop .x{ border:1px solid var(--border); background:#fff; border-radius:8px; padding:2px 8px; cursor:pointer; }
.asig-pop .x:hover{ filter:brightness(.96) }
.asig-pop .body{ max-height:54vh; overflow:auto; padding:8px 12px }
.asig-pop::after{
  content:""; position:absolute; top:-8px; left:24px;
  border-left:8px solid transparent; border-right:8px solid transparent;
  border-bottom:8px solid #fff; filter:drop-shadow(0 -1px 0 var(--border));
}
.asig-pop table{ width:100%; border-collapse:collapse }
.asig-pop th, .asig-pop td{ padding:8px; border-bottom:1px solid #eef1f3; text-align:left }
.asig-pop th{ background:#f7faf9; font-weight:800; color:#0f1e1d; font-size:.86rem }

/* ===== Menú contextual anclado a la tarjeta ===== */
.asig-card-menu{
  position:absolute; z-index:10610; display:none;
  background:#fff; border:1px solid var(--border); border-radius:10px;
  box-shadow:0 16px 40px rgba(0,0,0,.22); padding:6px; min-width:260px;
}
.asig-card-menu button{
  width:100%; text-align:left; padding:10px 12px; margin:6px 0;
  border:1px solid var(--border); background:#fff; border-radius:8px; cursor:pointer; font-size:.95rem;
}
.asig-card-menu button:hover{ background:#f6fbfa }

/* ===== Responsive refinamientos ===== */
@media (max-width:640px){
  .drawer{right:10px;width:92vw;top:auto;bottom:86px;max-height:58vh;border-radius:12px}
  .drawer .body{max-height:calc(58vh - 56px)}
}
