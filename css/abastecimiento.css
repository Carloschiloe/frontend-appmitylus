/* =========================================
   ABASTECIMIENTO – Overrides generales
   ========================================= */

/* ===== TABLAS: Contactos + Visitas ===== */
#tablaContactos.dataTable thead th,
#tablaVisitas.dataTable thead th {
  background: var(--primary, #1565c0) !important; /* ← fallback seguro */
  color: #fff !important;
}

#tablaContactos th, #tablaContactos td,
#tablaVisitas  th, #tablaVisitas  td {
  font-size: .92rem;
  padding: .38rem .5rem;
  border-bottom: 1px solid #e0e0e0;
}

#tablaContactos td .material-icons,
#tablaVisitas  td .material-icons {
  font-size: 1.22em;
  margin-right: 8px;
  transition: transform .12s ease, color .12s ease;
}

#tablaContactos td .material-icons:hover,
#tablaVisitas  td .material-icons:hover {
  color: var(--primary-acc, #26a69a);
  transform: scale(1.08);
}

/* ===== Celdas ellipsis comunes (Contactos + Visitas) ===== */
#tablaContactos .ellipsisCell,
#tablaVisitas  .ellipsisCell {
  display: inline-block;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  vertical-align: middle;
}
#tablaContactos .ellipsisProv,
#tablaVisitas  .ellipsisProv { max-width: 26ch; }
#tablaVisitas  .ellipsisObs  { max-width: 30ch; }

/* ===== CLICK en “Acciones” (VISITAS + CONTACTOS) ===== */
#tablaVisitas a[data-action],
#tablaContactos td:last-child a.icon-action {
  pointer-events: auto !important;
  cursor: pointer;
  display: inline-block;
  margin: 0 6px;
}
#tablaVisitas i.material-icons,
#tablaContactos td:last-child a.icon-action i.material-icons {
  pointer-events: none !important;
  font-size: 18px;
  vertical-align: middle;
}
#tab-visitas #tablaVisitas td:last-child {
  white-space: nowrap;
  pointer-events: auto !important;
}

/* ===== Contactos: tons async + footer ===== */
#tablaContactos .tons-cell.loading { opacity: .6; }
#tablaContactos tfoot th {
  font-weight: 700;
  background: #f6f6f7;
}

/* ===== BOTONES / TOOLBAR ===== */
#btnOpenContactoModal { margin: .25rem 0 .5rem; }

/* ===== MODALES ===== */
#modalContacto.modal,
#modalDetalleContacto.modal,
#modalVisita.modal,
#modalBloque.modal {
  max-width: 760px !important;
  max-height: 86vh !important;
  top: 7vh !important;
}
#modalContacto .modal-content,
#modalDetalleContacto .modal-content,
#modalVisita .modal-content,
#modalBloque .modal-content {
  max-height: 72vh !important;
}
#modalContacto .modal-footer,
#modalDetalleContacto .modal-footer,
#modalVisita .modal-footer,
#modalBloque .modal-footer {
  padding: .5rem .75rem !important;
}

#modalContacto .input-field input,
#modalContacto .input-field select,
#modalContacto .input-field textarea,
#modalVisita   .input-field input,
#modalVisita   .input-field select,
#modalVisita   .input-field textarea {
  margin-bottom: .6rem;
}

.modal .browser-default {
  width: 100%;
  background: transparent;
  border: none;
  border-bottom: 1px solid #9e9e9e;
  padding: 8px 0 6px;
  font-size: 16px;
}
.modal .browser-default:focus {
  outline: none;
  border-bottom: 2px solid #26a69a;
}
.modal .input-field label.active {
  transform: none !important;
  font-size: .9rem;
  color: #9e9e9e;
  margin-bottom: 2px;
  display: block;
}

/* Z-index alto por si DataTables/Charts crean contexts */
.modal         { z-index: 1005 !important; }
.modal-overlay { z-index: 1004 !important; }

.container, .card-panel { overflow: visible !important; }

/* ===== RESPONSIVE ===== */
@media (max-width: 992px) {
  #tablaContactos, #tablaContactos_wrapper,
  #tablaVisitas,  #tablaVisitas_wrapper {
    min-width: 360px !important;
    width: 100vw !important;
    display: block !important;
  }
  .dataTables_paginate { justify-content: center; }
}
@media (max-width: 600px) {
  #modalContacto.modal,
  #modalDetalleContacto.modal,
  #modalVisita.modal {
    width: 96% !important;
    top: 4vh !important;
  }
  #tablaContactos th, #tablaContactos td,
  #tablaVisitas  th, #tablaVisitas  td {
    font-size: .88rem;
    padding: .34rem .45rem;
  }
}

/* ===== UTILIDADES ===== */
.mt-12{margin-top:12px} .mt-14{margin-top:14px} .mt-18{margin-top:18px}
.mb-32{margin-bottom:32px}
.hidden{display:none!important}
.static-label{transform:none!important;font-size:.9rem;color:#9e9e9e}

/* ===== VISITAS: layout columnas ===== */
#tab-visitas #tablaVisitas {
  table-layout: fixed;
  width: 100%;
  border-collapse: collapse;
}
#tab-visitas #tablaVisitas th,
#tab-visitas #tablaVisitas td {
  box-sizing: border-box;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
  vertical-align: middle;
}

/* Anchos fijos */
#tab-visitas #tablaVisitas th:nth-child(1),
#tab-visitas #tablaVisitas td:nth-child(1) { width: 7rem; }
#tab-visitas #tablaVisitas th:nth-child(3),
#tab-visitas #tablaVisitas td:nth-child(3) { width: 8rem; }
#tab-visitas #tablaVisitas th:nth-child(4),
#tab-visitas #tablaVisitas td:nth-child(4) { width: 7rem; }
#tab-visitas #tablaVisitas th:nth-child(6),
#tab-visitas #tablaVisitas td:nth-child(6) { width: 6rem; text-align:right; }
#tab-visitas #tablaVisitas th:nth-child(8),
#tab-visitas #tablaVisitas td:nth-child(8) { width: 8rem; text-align:center; }

/* Flexibles con límites */
#tab-visitas #tablaVisitas th:nth-child(2),
#tab-visitas #tablaVisitas td:nth-child(2) { max-width: 24ch; }
#tab-visitas #tablaVisitas th:nth-child(5),
#tab-visitas #tablaVisitas td:nth-child(5) { max-width: 20ch; }
#tab-visitas #tablaVisitas th:nth-child(7),
#tab-visitas #tablaVisitas td:nth-child(7) { max-width: 30ch; }

/* Íconos en línea */
#tab-visitas #tablaVisitas td:nth-child(8){
  display: flex;
  justify-content: center;
  gap: 10px;
}

/* Responsive Visitas */
@media (max-width: 1024px) {
  #tab-visitas #tablaVisitas th:nth-child(2),
  #tab-visitas #tablaVisitas td:nth-child(2) { max-width: 20ch; }
  #tab-visitas #tablaVisitas th:nth-child(7),
  #tab-visitas #tablaVisitas td:nth-child(7) { max-width: 20ch; }
}
@media (max-width: 768px) {
  #tab-visitas #tablaVisitas th:nth-child(2),
  #tab-visitas #tablaVisitas td:nth-child(2) { max-width: 18ch; }
  #tab-visitas #tablaVisitas th:nth-child(5),
  #tab-visitas #tablaVisitas td:nth-child(5) { max-width: 16ch; }
}

/* ===== Fotos: ocultar input y full screen ===== */
#visita_fotos_input.filepick-input {
  position: absolute;
  left: 0; top: 0;
  width: 100%; height: 100%;
  opacity: 0;
  cursor: pointer;
  z-index: 2;
}
.filepick-wrap { position: relative; display: inline-block; }

/* Visor full screen */
.foto-viewer {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.9);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 2000;
}
.foto-viewer.open { display: flex; }

.foto-viewer img {
  max-width: 95vw;
  max-height: 95vh;
  object-fit: contain;
  box-shadow: 0 10px 40px rgba(0,0,0,.4);
}

.foto-viewer__close {
  position: absolute;
  top: 16px;
  right: 20px;
  background: rgba(255,255,255,.2);
  color: #fff;
  border: none;
  padding: 6px 10px;
  cursor: pointer;
  font-size: 20px;
  border-radius: 6px;
}
.foto-viewer__close:hover {
  background: rgba(255,255,255,.35);
}

/* Evita scroll en body cuando se abre el visor */
body.viewer-open { overflow: hidden; }

/* Modal Visita: textarea */
#modalVisita #visita_observaciones {
  min-height: 110px !important;
  overflow-y: auto;
  resize: vertical;
}

/* ===== Tablas utilitarias ===== */
.table-compact td, .table-compact th { padding: 6px 10px; }
.table-ellipsis td { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.table-actions a { margin-right: 6px; display: inline-flex; align-items: center; }

/* ===== Fotos de visitas (extra) ===== */
@import url('/js/abastecimiento/visitas/fotos/styles.css');
